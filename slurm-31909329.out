# Start Hartree-Fock computation
# Start CAS computation
# Nelder-Mead, 1
# Set target nvidia with options mqpu
# num gpus= 4
# Initial energy:  -221.21692381614574
# Start VQE minimization
# Num params: 8
# Qubits: 10
# N_layers: 1
# Energy after the VQE: -221.3878634462161
# Time for VQE [min]: 0.3190081278483073
# Start Hartree-Fock computation
# Start CAS computation
# Nelder-Mead, 1
# Set target nvidia with options mqpu
# num gpus= 4
# Initial energy:  -221.21692381614574
# Start VQE minimization
# Num params: 8
# Qubits: 10
# N_layers: 1
# Energy after the VQE: -221.38786447918284
# Time for VQE [min]: 0.3187330444653829
# Start Hartree-Fock computation
# Start CAS computation
# Nelder-Mead, 1
# Set target nvidia with options mqpu
# num gpus= 4
# Initial energy:  -221.21692381614585
# Start VQE minimization
# Num params: 8
# Qubits: 10
# N_layers: 1
# Energy after the VQE: -221.38786344621641
# Time for VQE [min]: 0.31907647053400673
# Start Hartree-Fock computation
# Start CAS computation
# Nelder-Mead, 1
# Set target nvidia with options mqpu
# num gpus= 4
# Initial energy:  -221.21692381614602
# Start VQE minimization
# Num params: 8
# Qubits: 10
# N_layers: 1
# Energy after the VQE: -221.38786344621653
# Time for VQE [min]: 0.31898610989252724
Traceback (most recent call last):
  File "/global/u2/z/zohim/tutorial_vqe/test.py", line 71, in <module>
    afqmc_msd = AFQMC.build(
  File "/global/homes/z/zohim/.local/lib/python3.10/site-packages/ipie/qmc/afqmc.py", line 377, in build
    walkers.build(
  File "/global/homes/z/zohim/.local/lib/python3.10/site-packages/ipie/walkers/uhf_walkers.py", line 225, in build
    self.ovlp = trial.calc_greens_function(self)
  File "/global/homes/z/zohim/.local/lib/python3.10/site-packages/ipie/trial_wavefunction/particle_hole.py", line 450, in calc_greens_function
    return greens_function_multi_det_wicks_opt(walkers, self)
  File "/global/homes/z/zohim/.local/lib/python3.10/site-packages/ipie/estimators/greens_function_multi_det.py", line 1144, in greens_function_multi_det_wicks_opt
    ovlp = numpy.dot(walker_batch.phia[iw].T, trial.psi0a.conj())
  File "<__array_function__ internals>", line 200, in dot
  File "cupy/_core/core.pyx", line 1719, in cupy._core.core._ndarray_base.__array_function__
  File "/usr/local/lib/python3.10/dist-packages/cupy/linalg/_product.py", line 63, in dot
    return a.dot(b, out)
TypeError: Argument 'b' has incorrect type (expected cupy._core.core._ndarray_base, got numpy.ndarray)
Traceback (most recent call last):
  File "/global/u2/z/zohim/tutorial_vqe/test.py", line 71, in <module>
    afqmc_msd = AFQMC.build(
  File "/global/homes/z/zohim/.local/lib/python3.10/site-packages/ipie/qmc/afqmc.py", line 377, in build
    walkers.build(
  File "/global/homes/z/zohim/.local/lib/python3.10/site-packages/ipie/walkers/uhf_walkers.py", line 225, in build
    self.ovlp = trial.calc_greens_function(self)
  File "/global/homes/z/zohim/.local/lib/python3.10/site-packages/ipie/trial_wavefunction/particle_hole.py", line 450, in calc_greens_function
    return greens_function_multi_det_wicks_opt(walkers, self)
  File "/global/homes/z/zohim/.local/lib/python3.10/site-packages/ipie/estimators/greens_function_multi_det.py", line 1144, in greens_function_multi_det_wicks_opt
    ovlp = numpy.dot(walker_batch.phia[iw].T, trial.psi0a.conj())
  File "<__array_function__ internals>", line 200, in dot
  File "cupy/_core/core.pyx", line 1719, in cupy._core.core._ndarray_base.__array_function__
  File "/usr/local/lib/python3.10/dist-packages/cupy/linalg/_product.py", line 63, in dot
    return a.dot(b, out)
TypeError: Argument 'b' has incorrect type (expected cupy._core.core._ndarray_base, got numpy.ndarray)
Traceback (most recent call last):
  File "/global/u2/z/zohim/tutorial_vqe/test.py", line 71, in <module>
    afqmc_msd = AFQMC.build(
  File "/global/homes/z/zohim/.local/lib/python3.10/site-packages/ipie/qmc/afqmc.py", line 377, in build
    walkers.build(
  File "/global/homes/z/zohim/.local/lib/python3.10/site-packages/ipie/walkers/uhf_walkers.py", line 225, in build
    self.ovlp = trial.calc_greens_function(self)
  File "/global/homes/z/zohim/.local/lib/python3.10/site-packages/ipie/trial_wavefunction/particle_hole.py", line 450, in calc_greens_function
    return greens_function_multi_det_wicks_opt(walkers, self)
  File "/global/homes/z/zohim/.local/lib/python3.10/site-packages/ipie/estimators/greens_function_multi_det.py", line 1144, in greens_function_multi_det_wicks_opt
    ovlp = numpy.dot(walker_batch.phia[iw].T, trial.psi0a.conj())
  File "<__array_function__ internals>", line 200, in dot
  File "cupy/_core/core.pyx", line 1719, in cupy._core.core._ndarray_base.__array_function__
  File "/usr/local/lib/python3.10/dist-packages/cupy/linalg/_product.py", line 63, in dot
    return a.dot(b, out)
TypeError: Argument 'b' has incorrect type (expected cupy._core.core._ndarray_base, got numpy.ndarray)
Traceback (most recent call last):
  File "/global/u2/z/zohim/tutorial_vqe/test.py", line 71, in <module>
    afqmc_msd = AFQMC.build(
  File "/global/homes/z/zohim/.local/lib/python3.10/site-packages/ipie/qmc/afqmc.py", line 377, in build
    walkers.build(
  File "/global/homes/z/zohim/.local/lib/python3.10/site-packages/ipie/walkers/uhf_walkers.py", line 225, in build
    self.ovlp = trial.calc_greens_function(self)
  File "/global/homes/z/zohim/.local/lib/python3.10/site-packages/ipie/trial_wavefunction/particle_hole.py", line 450, in calc_greens_function
    return greens_function_multi_det_wicks_opt(walkers, self)
  File "/global/homes/z/zohim/.local/lib/python3.10/site-packages/ipie/estimators/greens_function_multi_det.py", line 1144, in greens_function_multi_det_wicks_opt
    ovlp = numpy.dot(walker_batch.phia[iw].T, trial.psi0a.conj())
  File "<__array_function__ internals>", line 200, in dot
  File "cupy/_core/core.pyx", line 1719, in cupy._core.core._ndarray_base.__array_function__
  File "/usr/local/lib/python3.10/dist-packages/cupy/linalg/_product.py", line 63, in dot
    return a.dot(b, out)
TypeError: Argument 'b' has incorrect type (expected cupy._core.core._ndarray_base, got numpy.ndarray)
srun: error: nid003736: tasks 0,2: Exited with exit code 1
srun: Terminating StepId=31909329.0
srun: error: nid003736: tasks 1,3: Exited with exit code 1
